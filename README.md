# DeepFakeFace

### Introduction

To protect the privacy of celebrities, we propose DeepFakeFace(DFF) dataset generated by advanced diffusion models.

Code accompanying the paper
"Robustness and Generalizability of Deepfake Detection: A Study with Diffusion Models". [[Website](https://sites.google.com/view/deepfakeface/home)] [[paper](./)].

### Installation

[Diffusers](https://huggingface.co/docs/diffusers/installation), [Pytorch](https://pytorch.org/get-started/locally/), [InsightFace](https://github.com/deepinsight/insightface)

### Generate mask images required for deepfakes generated by Stabel Diffusion Inpainting

process.py generates correponding mask images according to the label file of wiki. The mask images can also be generated by
other SOTA face detection methods such as [RetinaFace](https://github.com/biubug6/Pytorch_Retinaface).

```bash
python process.py
```

### Generate deepfake by Stable Diffusion V1.5

```bash
python generate_text2img.py
```

### Generate deepfake by Stable Diffusion Inpainting

```bash
python generate_inpainting.py
```

### Generate deepfake by InsightFace

[InsightFace](https://github.com/deepinsight/insightface) is a powerful toolbox for swapping faces.

```bash
python generate_insight.py
```

### Evaluation

We emplot SOTA detection method [RECCE](https://github.com/VISION-SJTU/RECCE) to detect deepfakes. As for distortion, we apply the same setting with [DeeperForensics](https://github.com/EndlessSora/DeeperForensics-1.0) to evaluate the robustness of detection methods.

```bash
python add_distortion.py
```

### Cite

Please cite our paper if you use our codes or our dataset in your own work:

<!-- ```
@article{lin2023tizero,
  title={TiZero: Mastering Multi-Agent Football with Curriculum Learning and Self-Play},
  author={Lin, Fanqi and Huang, Shiyu and Pearce, Tim and Chen, Wenze and Tu, Wei-Wei},
  journal={arXiv preprint arXiv:2302.07515},
  year={2023}
}
``` -->
